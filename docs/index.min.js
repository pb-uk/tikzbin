
document.getElementById('input').value = '\\begin{tikzpicture}\r\n  \\draw (0,0) circle (4cm);\r\n\\end{tikzpicture}';
var sourceChanged = async () => {
  const scriptEl = document.createElement('script');
  scriptEl.innerHTML = document.getElementById('input').value;
  scriptEl.setAttribute('type', 'text/tikz');
  document.getElementById('rendered').append(scriptEl);
  await window.onload();
};

var captureSvg = () => {
  const svg = document.getElementById('rendered').firstChild.innerHTML;
  const base64 = 'data:image/svg+xml;base64,' + btoa(svg.replace('<svg', '<?xml version="1.0" encoding="UTF-8" ?>\n<svg xmlns="http://www.w3.org/2000/svg"'));
  const downloadLink = document.createElement('a');
  downloadLink.href = base64;
  downloadLink.download = 'tikz.svg';
  downloadLink.click();
};
